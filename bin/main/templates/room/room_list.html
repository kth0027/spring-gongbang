<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>개설중인 클래스 리스트</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
</head>
<body>
<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>

<div th:replace="header.html::header"></div>

<!--

@Author : 김정진
@Date : 2022-02-08

1. 검색해서 들어오면 리스트로 출력
2. '지도 표시하기' 버튼을 클릭하면 화면 전환 후 지도 출력


-->

<div class="container">
    <h3>개설중인 클래스 리스트</h3>
    <div class="row">
        <!-- 룸 1개당 반복문-->
        <div class="col-md-4" style="overflow-y: auto; height:700px;" >
            <div th:each="room : ${roomEntities}">
                <div class="row">
                    <div class="col-md-5">
                        <a th:href="@{ '/room/view/' + ${room.roomNo} }"
                           class="logo d-flex align-items-center text-white text-decoration-none">
                            <img th:src="@{ '/roomimg/' + ${room.roomImgEntities.get(0).roomImg} }"
                                 style="width: 100%;">
                        </a>
                    </div>
                    <div class="col-md-7">
                        <div th:text="${room.roomNo}"></div>
                        <div th:text="${room.roomTitle}"></div>
                        <div th:text="${room.roomCategory}"></div>
                        <div th:text="${room.roomMax}"></div>
                        <div th:text="${room.roomStatus}"></div>
                        <div th:text="${#strings.listSplit(room.roomAddress,',')[0]}"></div>
                        <div>
                            <button th:onclick="roomnavy([[${room.roomNo}]])" data-bs-target="#modalnavy"
                                    data-bs-toggle="modal">길찾기
                            </button>
                        </div>
                    </div>
                    <br>
                </div>
            </div>
            <ul class="pagination justify-content-center"
                th:with="start=${T(Math).floor(roomEntities.number/10) * 10 + 1 } ,
                                 last=(${start + 9 < roomEntities.totalPages ?  start + 9 : roomEntities.totalPages })">
                <!-- &lt;!&ndash; 첫페이지이동 &ndash;&gt;-->
                <li class="page-item">
                    <a class="page-link" th:href="@{/room/list(page=1)}"> << </a>
                </li>
                <!--   &lt;!&ndash; 이전페이지이동 &ndash;&gt;-->
                <li class="page-item" th:class="${roomEntities.first}?'disabled'">
                    <!--&lt;!&ndash; 첫번페이지에서 이전페이지이동 표시 x &ndash;&gt;-->
                    <a class="page-link"
                       th:href="${roomEntities.first} ? '#' : @{/room/list(page=${ roomEntities.number })}"> < </a>
                </li>
                <!--     &lt;!&ndash; 페이지번호 &ndash;&gt;-->
                <li class="page-item" th:each="page : ${#numbers.sequence( start , last ) }">
                    <a class="page-link" th:href="@{/room/list(page=${page})}" th:text="${page}"> </a>
                </li>
                <!-- &lt;!&ndash; 다음페이지이동 &ndash;&gt;-->
                <li class="page-item" th:class="${roomEntities.last}?'disabled'">
                    <a class="page-link"
                       th:href="${roomEntities.last} ? '#' : @{/room/list(page=${roomEntities.number+2})}"> > </a>
                </li>
                <!--  &lt;!&ndash; 마지막페이지 이동 &ndash;&gt;-->
                <li class="page-item">
                    <a class="page-link" th:href="@{/room/list(page=${roomEntities.totalPages})}"> >> </a>
                </li>
            </ul>
        </div>

        <!--
        1. '지도 표시하기' 버튼 클릭 시 화면에 있는 결과물들을 지도에 출력
        2. 아무 검색도 없이 들어온 경우
        3.
        -->
        <div class="col-md-8">
            <div id="map" style="width:100%;height:700px; "></div>
        </div>


    </div>
</div>


<div class="modal fade" id="modalnavy" data-keyboard="false" data-backdrop="static" tabindex="-1" role="dialog"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content rounded-5 shadow">
            <div class="modal-header p-5 pb-4 border-bottom-0">
                <h2 class="fw-bold mb-0 text-center w-100">
                    <p class="text-center">찾아오는 길</p></h2>
                <input id="road" type="hidden">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
                        style="width:2rem;"></button>
                <!-- 닫기 버튼 -->
            </div>
            <div class="modal-body p-5 pt-0" id="modalnavy1">

                <div class="ft_area">
                    <div class="ft_select_wrap">
                        <div class="ft_select">
                            <select id="selectLevel">
                                <option value="0" selected="selected">교통최적+추천</option>
                                <option value="1">교통최적+무료우선</option>
                                <option value="2">교통최적+최소시간</option>
                                <option value="3">교통최적+초보</option>
                                <option value="4">교통최적+고속도로우선</option>
                                <option value="10">최단거리+유/무료</option>
                                <option value="12">이륜차도로우선</option>
                                <option value="19">교통최적+어린이보호구역 회피</option>
                            </select> <select id="year">
                            <option value="N" selected="selected">교통정보 표출 옵션</option>
                            <option value="Y">Y</option>
                            <option value="N">N</option>
                        </select>
                            <button id="btn_select">길찾기</button>
                        </div>
                    </div>
                    <br>
                    <div class="map_act_btn_wrap clear_box"></div>
                    <div class="clear"></div>
                </div>
                <div id="map_wrap" class="map_wrap">
                    <div id="map_div"></div>
                </div>
                <br>
                <div class="map_act_btn_wrap clear_box"></div>
                <p id="result"></p>

            </div>
        </div>
    </div>
</div>


<script src="https://apis.openapi.sk.com/tmap/jsv2?version=1&appKey=l7xx1a649f9e9e5642ed82f72ada2ff00e9d"></script>
<script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=c4b311c12f156511eb9b89bf63938e65&libraries=clusterer"></script>
<script th:src="@{/js/roomview.js}"></script>
<script th:src="@{/js/roomnavy.js}"></script>
</body>
</html>